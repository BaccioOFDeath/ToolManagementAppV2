<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
        xmlns:local="clr-namespace:ToolManagementAppV2.Utilities.Converters"
        xmlns:av="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="av"
        x:Class="ToolManagementAppV2.MainWindow"
        Title="Tool Inventory Management"
        Height="750"
        Width="1600"
        WindowStartupLocation="CenterScreen">
    <DockPanel Margin="10">
        <!-- Global Resources -->
        <DockPanel.Resources>
            <local:CheckOutStatusConverter x:Key="CheckOutStatusConverter"/>
            <local:NullToDefaultImageConverter x:Key="NullToDefaultImageConverter"/>
            <local:InverseBooleanConverter x:Key="InverseBooleanConverter"/>
            <DataTemplate x:Key="CheckOutButtonTemplate">
                <Button Content="{Binding IsCheckedOut, Converter={StaticResource CheckOutStatusConverter}}"
                Click="CheckOutButton_Click"
                CommandParameter="{Binding ToolID}" />
            </DataTemplate>
            <Style x:Key="ToolImageTooltipStyle" TargetType="ListViewItem">
                <Setter Property="ToolTip">
                    <Setter.Value>
                        <Border BorderBrush="Gray" BorderThickness="1" Padding="2" Background="White">
                            <Image Width="400" Height="400" Stretch="Uniform"
                       Source="{Binding ToolImagePath, Converter={StaticResource NullToDefaultImageConverter}, ConverterParameter=Tool}"/>
                        </Border>
                    </Setter.Value>
                </Setter>
            </Style>
        </DockPanel.Resources>

        <!-- Header with Logo and Title -->
        <Border DockPanel.Dock="Top" Background="#DDD" Padding="10">
            <DockPanel>
                <Image x:Name="HeaderIcon" Source="{Binding HeaderLogo}" Width="50" Height="50" />
                <!-- give this a name so code-behind can update it -->
                <TextBlock x:Name="HeaderTitle"
                           Text="Tool Inventory Management"
                           FontWeight="Bold"
                           FontSize="20"
                           Margin="10"
                           VerticalAlignment="Center"/>
                <StackPanel DockPanel.Dock="Right" Orientation="Horizontal" HorizontalAlignment="Right" Margin="5">
                    <Image Source="{Binding CurrentUserPhoto}" Width="50" Height="50" Margin="0,0,10,0" />
                    <StackPanel Orientation="Vertical">
                        <TextBlock Text="{Binding CurrentUserName}" FontWeight="Bold" Margin="0,0,0,5" />
                        <Button Content="Logout" Click="LogoutButton_Click" Width="80" />
                    </StackPanel>
                </StackPanel>
            </DockPanel>
        </Border>


        <!-- Main Content Area -->
        <Grid DockPanel.Dock="Top">
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <TabControl x:Name="MyTabControl" Margin="5" Grid.Row="0" SelectionChanged="MyTabControl_SelectionChanged">
                <TabItem Header="Dashboard">
                    <Grid Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="10">
                            <Button Content="Search Tools" Command="{Binding OpenSearchToolsCommand}" Width="200" Margin="10"/>
                            <Button Content="Manage Tools" Command="{Binding OpenManageToolsCommand}" Width="200" Margin="10"/>
                            <Button Content="Rentals" Command="{Binding OpenRentalsCommand}" Width="200" Margin="10"/>
                            <Button Content="Customers" Command="{Binding OpenCustomersCommand}" Width="200" Margin="10"/>
                            <Button Content="Reports" Command="{Binding OpenReportsCommand}" Width="200" Margin="10"/>
                            <Button Content="Settings" Command="{Binding OpenSettingsCommand}" Width="200" Margin="10"/>
                        </StackPanel>

                        <GroupBox Header="Quick Summary" Grid.Row="1" Margin="10">
                            <StackPanel Margin="10">
                                <TextBlock Text="{Binding TotalToolsSummary}" FontSize="14" Margin="5"/>
                                <TextBlock Text="{Binding TotalCustomersSummary}" FontSize="14" Margin="5"/>
                                <TextBlock Text="{Binding ActiveRentalsSummary}" FontSize="14" Margin="5"/>
                                <TextBlock Text="{Binding OverdueRentalsSummary}" FontSize="14" Margin="5"/>
                                <TextBlock Text="{Binding ActivityLogsSummary}" FontSize="14" Margin="5"/>
                            </StackPanel>
                        </GroupBox>
                    </Grid>
                </TabItem>

                <!-- Search Tools Tab -->
                <TabItem Header="Tool Search">
                    <Grid Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                            <xctk:WatermarkTextBox x:Name="SearchInput" Width="400" Margin="5" Watermark="Search Tools..." TextChanged="SearchInput_TextChanged" />
                            <Button Content="Print Search" Click="PrintSearchResults_Click" Width="150" Margin="5"/>
                            <Button Content="Print My Tools" Click="PrintMyCheckedOutTools_Click" Width="150" Margin="5"/>
                            <Button Content="Rent Tool" Command="{Binding RentToolCommand}" Width="150" Margin="5"/>
                            <Button Content="Rental History" Command="{Binding ViewRentalHistoryCommand}" Width="150" Margin="5"/>
                        </StackPanel>

                        <ListView x:Name="SearchResultsList" ItemContainerStyle="{StaticResource ToolImageTooltipStyle}" 
                  ItemsSource="{Binding SearchResults}" SelectedItem="{Binding SelectedTool, Mode=TwoWay}" 
                  Margin="0,0,0,10" Grid.Row="1" ScrollViewer.VerticalScrollBarVisibility="Auto">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="Action" Width="80" CellTemplate="{StaticResource CheckOutButtonTemplate}"/>
                                    <GridViewColumn Header="Tool #" DisplayMemberBinding="{Binding ToolNumber}" Width="120"/>
                                    <GridViewColumn Header="Name" DisplayMemberBinding="{Binding NameDescription}" Width="380"/>
                                    <GridViewColumn Header="Part #" DisplayMemberBinding="{Binding PartNumber}" Width="100"/>
                                    <GridViewColumn Header="Brand" DisplayMemberBinding="{Binding Brand}" Width="100"/>
                                    <GridViewColumn Header="Qty" DisplayMemberBinding="{Binding QuantityOnHand}" Width="60"/>
                                    <GridViewColumn Header="Supplier" DisplayMemberBinding="{Binding Supplier}" Width="100"/>
                                    <GridViewColumn Header="Purchased" Width="100">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding PurchasedDate, StringFormat=\{0:yyyy-MM-dd\}}" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                    <GridViewColumn Header="Notes" Width="250">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Notes}" TextWrapping="Wrap"/>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                    <GridViewColumn Header="Image" Width="100">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <Image Source="{Binding ToolImagePath, Converter={StaticResource NullToDefaultImageConverter}, ConverterParameter=Tool}" 
                                       Width="50" Height="50" Stretch="Uniform"/>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                </GridView>
                            </ListView.View>
                        </ListView>

                        <GroupBox Header="My Checked-Out Tools" Grid.Row="2" Margin="0,10,0,0">
                            <ListView x:Name="CheckedOutToolsList" ItemContainerStyle="{StaticResource ToolImageTooltipStyle}" 
                      ItemsSource="{Binding CheckedOutTools}" SelectedItem="{Binding SelectedTool, Mode=TwoWay}">
                                <ListView.View>
                                    <GridView>
                                        <GridViewColumn Header="Action" Width="80" CellTemplate="{StaticResource CheckOutButtonTemplate}"/>
                                        <GridViewColumn Header="Tool ID" DisplayMemberBinding="{Binding ToolID}" Width="80"/>
                                        <GridViewColumn Header="Name" DisplayMemberBinding="{Binding NameDescription}" Width="300"/>
                                        <GridViewColumn Header="Checked Out By" DisplayMemberBinding="{Binding CheckedOutBy}" Width="150"/>
                                        <GridViewColumn Header="Checked Out Time" DisplayMemberBinding="{Binding CheckedOutTime, StringFormat=\{0:G\}}" Width="150"/>
                                        <GridViewColumn Header="Location" DisplayMemberBinding="{Binding Location}" Width="100"/>
                                    </GridView>
                                </ListView.View>
                            </ListView>
                        </GroupBox>
                    </Grid>
                </TabItem>


                <!-- Tool Management Tab -->
                <TabItem Header="Tool Management">
                    <Grid Margin="10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="400"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <GroupBox Header="Tool Editor" Grid.Column="0" Margin="0,0,10,0">
                            <Grid Margin="5">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Text="Tool Number:" Grid.Row="0"/>
                                <xctk:WatermarkTextBox Text="{Binding NewTool.ToolNumber, Mode=TwoWay}" Grid.Row="0" Grid.Column="1" Watermark="Tool Number" Margin="0,2"/>

                                <TextBlock Text="Name:" Grid.Row="1"/>
                                <xctk:WatermarkTextBox Text="{Binding NewTool.NameDescription, Mode=TwoWay}" Grid.Row="1" Grid.Column="1" Watermark="Tool Name" Margin="0,2"/>

                                <TextBlock Text="Part Number:" Grid.Row="2"/>
                                <xctk:WatermarkTextBox Text="{Binding NewTool.PartNumber, Mode=TwoWay}" Grid.Row="2" Grid.Column="1" Watermark="Part Number" Margin="0,2"/>

                                <TextBlock Text="Brand:" Grid.Row="3"/>
                                <xctk:WatermarkTextBox Text="{Binding NewTool.Brand, Mode=TwoWay}" Grid.Row="3" Grid.Column="1" Watermark="Brand" Margin="0,2"/>

                                <TextBlock Text="Location:" Grid.Row="4"/>
                                <xctk:WatermarkTextBox Text="{Binding NewTool.Location, Mode=TwoWay}" Grid.Row="4" Grid.Column="1" Watermark="Location" Margin="0,2"/>

                                <TextBlock Text="Quantity:" Grid.Row="5"/>
                                <xctk:WatermarkTextBox Text="{Binding NewTool.QuantityOnHand, Mode=TwoWay}" Grid.Row="5" Grid.Column="1" Watermark="Quantity" Margin="0,2"/>

                                <TextBlock Text="Supplier:" Grid.Row="6"/>
                                <xctk:WatermarkTextBox Text="{Binding NewTool.Supplier, Mode=TwoWay}" Grid.Row="6" Grid.Column="1" Watermark="Supplier" Margin="0,2"/>

                                <TextBlock Text="Purchased Date:" Grid.Row="7"/>
                                <xctk:WatermarkTextBox Text="{Binding NewTool.PurchasedDate, Mode=TwoWay, StringFormat=yyyy-MM-dd}" Grid.Row="7" Grid.Column="1" Watermark="yyyy-MM-dd" Margin="0,2"/>

                                <TextBlock Text="Notes:" Grid.Row="8"/>
                                <xctk:WatermarkTextBox Text="{Binding NewTool.Notes, Mode=TwoWay}" Grid.Row="8" Grid.Column="1" Watermark="Notes" AcceptsReturn="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" Margin="0,2" Height="100"/>

                                <Button Content="Add/Change Tool Image" Click="ChangeToolImage_Click" Grid.Row="9" Grid.ColumnSpan="2" Margin="0,10,0,0"/>

                                <StackPanel Grid.Row="10" Grid.ColumnSpan="2" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,10,0,0">
                                    <Button Content="Add" Command="{Binding AddToolCommand}" Margin="5"/>
                                    <Button Content="Update" Command="{Binding UpdateToolCommand}" Margin="5"/>
                                    <Button Content="Delete" Command="{Binding DeleteToolCommand}" Margin="5"/>
                                </StackPanel>
                            </Grid>
                        </GroupBox>

                        <ListView x:Name="ToolsList" Grid.Column="1" ItemContainerStyle="{StaticResource ToolImageTooltipStyle}" 
                  ItemsSource="{Binding Tools}" SelectedItem="{Binding SelectedTool, Mode=TwoWay}">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="Tool #" DisplayMemberBinding="{Binding ToolNumber}" Width="100"/>
                                    <GridViewColumn Header="Name" DisplayMemberBinding="{Binding NameDescription}" Width="250"/>
                                    <GridViewColumn Header="Part #" DisplayMemberBinding="{Binding PartNumber}" Width="100"/>
                                    <GridViewColumn Header="Brand" DisplayMemberBinding="{Binding Brand}" Width="100"/>
                                    <GridViewColumn Header="Location" DisplayMemberBinding="{Binding Location}" Width="100"/>
                                    <GridViewColumn Header="Qty" DisplayMemberBinding="{Binding QuantityOnHand}" Width="60"/>
                                    <GridViewColumn Header="Supplier" DisplayMemberBinding="{Binding Supplier}" Width="100"/>
                                    <GridViewColumn Header="Purchased" Width="100">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding PurchasedDate, StringFormat=\{0:yyyy-MM-dd\}}"/>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                    <GridViewColumn Header="Notes" Width="300">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Notes}" TextWrapping="Wrap"/>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                    <GridViewColumn Header="Image" Width="100">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <Image Source="{Binding ToolImagePath, Converter={StaticResource NullToDefaultImageConverter}}" Width="50" Height="50" Stretch="Uniform"/>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                </GridView>
                            </ListView.View>
                        </ListView>
                    </Grid>
                </TabItem>

                <!-- Rentals Management Tab -->
                <TabItem Header="Rentals">
                    <Grid Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <GroupBox Header="Rental Operations" Grid.Row="0" Margin="0,0,0,10">
                            <StackPanel Orientation="Vertical" Margin="5">

                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                    <Button Content="Return Tool" Command="{Binding ReturnToolCommand}" Width="120" Margin="5"/>
                                    <Button Content="Print Receipt" Click="PrintRentalReceipt_Click" Width="120" Margin="5"/>
                                    <Button Content="Tool History" Command="{Binding ViewSelectedRentalHistoryCommand}" Width="120" Margin="5"/>
                                    <Button Content="Customer History" Command="{Binding ViewSelectedCustomerHistoryCommand}" Width="120" Margin="5"/>
                                </StackPanel>

                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                    <xctk:WatermarkTextBox x:Name="RentalIDInput" Watermark="Rental ID" Width="120" Margin="5" IsReadOnly="True" Text="{Binding SelectedRental.RentalID}"/>
                                    <DatePicker x:Name="NewDueDateInput" SelectedDate="{Binding NewDueDate, Mode=TwoWay}" Width="150" Margin="5"/>
                                    <Button Content="Extend Rental" Command="{Binding ExtendRentalCommand}" Width="150" Margin="5"/>
                                    <Button Content="Overdue Rentals" Command="{Binding LoadOverdueRentalsCommand}" Width="150" Margin="5"/>
                                </StackPanel>

                            </StackPanel>
                        </GroupBox>

                        <ListView x:Name="RentalsList" ItemsSource="{Binding ActiveRentals}" SelectedItem="{Binding SelectedRental, Mode=TwoWay}" Grid.Row="1">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="Rental ID" DisplayMemberBinding="{Binding RentalID}" Width="80"/>
                                    <GridViewColumn Header="Tool" DisplayMemberBinding="{Binding ToolNumber}" Width="120"/>
                                    <GridViewColumn Header="Customer" DisplayMemberBinding="{Binding CustomerName}" Width="150"/>
                                    <GridViewColumn Header="Rental Date" DisplayMemberBinding="{Binding RentalDate, StringFormat=\{0:yyyy-MM-dd\}}" Width="120"/>
                                    <GridViewColumn Header="Due Date" DisplayMemberBinding="{Binding DueDate, StringFormat=\{0:yyyy-MM-dd\}}" Width="120"/>
                                    <GridViewColumn Header="Return Date" DisplayMemberBinding="{Binding ReturnDate, StringFormat=\{0:yyyy-MM-dd\}}" Width="120"/>
                                </GridView>
                            </ListView.View>
                        </ListView>
                    </Grid>
                </TabItem>


                <!-- Customers Management Tab -->
                <TabItem Header="Customers">
                    <Grid Margin="10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="400"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <GroupBox Header="Customer Editor" Grid.Column="0" Margin="0,0,10,0">
                            <StackPanel Margin="5">

                                <xctk:WatermarkTextBox x:Name="CustomerNameInput" Watermark="Company Name" Text="{Binding NewCustomerName, Mode=TwoWay}" Margin="5"/>
                                <xctk:WatermarkTextBox x:Name="CustomerEmailInput" Watermark="Email" Text="{Binding NewCustomerEmail, Mode=TwoWay}" Margin="5"/>
                                <xctk:WatermarkTextBox x:Name="CustomerContactInput" Watermark="Contact" Text="{Binding NewCustomerContact, Mode=TwoWay}" Margin="5"/>
                                <xctk:WatermarkTextBox x:Name="CustomerPhoneInput" Watermark="Phone" Text="{Binding NewCustomerPhone, Mode=TwoWay}" Margin="5"/>
                                <xctk:WatermarkTextBox x:Name="CustomerMobileInput" Watermark="Mobile" Text="{Binding NewCustomerMobile, Mode=TwoWay}" Margin="5"/>
                                <xctk:WatermarkTextBox x:Name="CustomerAddressInput" Watermark="Address" Text="{Binding NewCustomerAddress, Mode=TwoWay}" Margin="5"/>

                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="10,20,10,0">
                                    <Button Content="Add" Command="{Binding AddCustomerCommand}" Margin="5" Width="80"/>
                                    <Button Content="Update" Command="{Binding UpdateCustomerCommand}" Margin="5" Width="80"/>
                                    <Button Content="Delete" Command="{Binding DeleteCustomerCommand}" Margin="5" Width="80"/>
                                </StackPanel>

                            </StackPanel>
                        </GroupBox>

                        <Grid Grid.Column="1">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <xctk:WatermarkTextBox x:Name="CustomerSearchInput" Watermark="Search Customers..." TextChanged="CustomerSearchInput_TextChanged" Margin="0,0,0,10" Width="300"/>

                            <ListView x:Name="CustomerList" ItemsSource="{Binding Customers}" SelectedItem="{Binding SelectedCustomer, Mode=TwoWay}" SelectionChanged="CustomerList_SelectionChanged" Grid.Row="1">
                                <ListView.View>
                                    <GridView>
                                        <GridViewColumn Header="Company" DisplayMemberBinding="{Binding Company}" Width="180"/>
                                        <GridViewColumn Header="Email" DisplayMemberBinding="{Binding Email}" Width="200"/>
                                        <GridViewColumn Header="Contact" DisplayMemberBinding="{Binding Contact}" Width="150"/>
                                        <GridViewColumn Header="Phone" DisplayMemberBinding="{Binding Phone}" Width="120"/>
                                        <GridViewColumn Header="Mobile" DisplayMemberBinding="{Binding Mobile}" Width="120"/>
                                        <GridViewColumn Header="Address" DisplayMemberBinding="{Binding Address}" Width="300"/>
                                    </GridView>
                                </ListView.View>
                            </ListView>

                        </Grid>
                    </Grid>
                </TabItem>

                <!-- Users Management Tab -->
                <TabItem Header="Users">
                    <Grid Margin="10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="400"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <GroupBox Header="User Editor" Grid.Column="0" Margin="0,0,10,0">
                            <StackPanel Margin="5">

                                <StackPanel Orientation="Horizontal" Margin="5">
                                    <Border Width="100" Height="100" BorderBrush="Gray" BorderThickness="1">
                                        <Image Source="{Binding SelectedUser.PhotoBitmap, ConverterParameter=User, Converter={StaticResource NullToDefaultImageConverter}}" Stretch="UniformToFill"/>
                                    </Border>
                                    <Button Content="Change Photo" Command="{Binding UploadUserPhotoCommand}" Margin="10,0,0,0" VerticalAlignment="Center"/>
                                </StackPanel>

                                <xctk:WatermarkTextBox Watermark="User Name" Text="{Binding SelectedUser.UserName, Mode=TwoWay}" Margin="5"/>
                                <PasswordBox x:Name="PasswordBox" PasswordChanged="PasswordBox_PasswordChanged" Margin="5"/>
                                <xctk:WatermarkTextBox Watermark="Email" Text="{Binding SelectedUser.Email, Mode=TwoWay}" Margin="5"/>
                                <xctk:WatermarkTextBox Watermark="Phone" Text="{Binding SelectedUser.Phone, Mode=TwoWay}" Margin="5"/>
                                <xctk:WatermarkTextBox Watermark="Mobile" Text="{Binding SelectedUser.Mobile, Mode=TwoWay}" Margin="5"/>
                                <xctk:WatermarkTextBox Watermark="Address" Text="{Binding SelectedUser.Address, Mode=TwoWay}" Margin="5"/>
                                <xctk:WatermarkTextBox Watermark="Role" Text="{Binding SelectedUser.Role, Mode=TwoWay}" Margin="5"/>

                                <StackPanel Orientation="Horizontal" Margin="5">
                                    <TextBlock Text="Is Admin:" Width="100" VerticalAlignment="Center"/>
                                    <CheckBox IsChecked="{Binding SelectedUser.IsAdmin, Mode=TwoWay}" IsEnabled="{Binding IsLastAdmin, Converter={StaticResource InverseBooleanConverter}}"/>
                                </StackPanel>

                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="10,20,10,0">
                                    <Button Content="New" Click="NewUserButton_Click" Margin="5" Width="80"/>
                                    <Button Content="Delete" Click="DeleteUserButton_Click" Margin="5" Width="80"/>
                                    <Button Content="Save" Click="SaveUserButton_Click" Margin="5" Width="80"/>
                                </StackPanel>

                            </StackPanel>
                        </GroupBox>

                        <ListView x:Name="UserList" ItemsSource="{Binding Users}" SelectedItem="{Binding SelectedUser, Mode=TwoWay}" Margin="0,0,0,10" Grid.Column="1">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="User Name" DisplayMemberBinding="{Binding UserName}" Width="180"/>
                                    <GridViewColumn Header="Admin" Width="80">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <CheckBox IsChecked="{Binding IsAdmin}" IsEnabled="False" HorizontalAlignment="Center"/>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                </GridView>
                            </ListView.View>
                        </ListView>
                    </Grid>
                </TabItem>


                <!-- Settings Tab -->
                <TabItem Header="Settings">
                    <Grid Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <GroupBox Header="General Settings" Grid.Row="0" Margin="0,0,0,10">
                            <StackPanel Margin="5">

                                <StackPanel Orientation="Horizontal" Margin="5">
                                    <TextBlock Text="Application Name:" Width="200" VerticalAlignment="Center"/>
                                    <TextBox x:Name="ApplicationNameInput" Width="250" Margin="5"/>
                                </StackPanel>

                                <StackPanel Orientation="Horizontal" Margin="5">
                                    <TextBlock Text="Default Rental Duration (days):" Width="200" VerticalAlignment="Center"/>
                                    <xctk:WatermarkTextBox x:Name="RentalDurationInput" Text="7" Width="100" Margin="5"/>
                                </StackPanel>

                                <StackPanel Orientation="Horizontal" Margin="5">
                                    <TextBlock Text="Company Logo:" Width="200" VerticalAlignment="Center"/>
                                    <Image x:Name="LogoPreview" Width="100" Height="100" Stretch="Uniform" Margin="5"/>
                                    <Button Content="Upload Logo" Click="UploadLogoButton_Click" Margin="5"/>
                                </StackPanel>

                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Margin="5">
                                    <Button Content="Save Settings" Click="SaveSettingsButton_Click" Width="150" Margin="5"/>
                                    <Button Content="Load Settings" Click="LoadAllSettingsButton_Click" Width="150" Margin="5"/>
                                </StackPanel>

                            </StackPanel>
                        </GroupBox>

                        <GroupBox Header="Advanced Settings" Grid.Row="1">
                            <StackPanel Margin="5">
                                <ListView x:Name="SettingsList" Height="200" Margin="5">
                                    <ListView.View>
                                        <GridView>
                                            <GridViewColumn Header="Key" DisplayMemberBinding="{Binding Key}" Width="200"/>
                                            <GridViewColumn Header="Value" Width="200">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBox Text="{Binding Value}" Width="180"/>
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                        </GridView>
                                    </ListView.View>
                                </ListView>

                                <StackPanel Orientation="Horizontal" Margin="5">
                                    <Button Content="Bulk Update" Click="BulkUpdateSettingsButton_Click" Width="120" Margin="5"/>
                                    <Button Content="Delete Setting" Click="DeleteSettingButton_Click" Width="120" Margin="5"/>
                                </StackPanel>
                            </StackPanel>
                        </GroupBox>
                    </Grid>
                </TabItem>
                <TabItem Header="Import/Export">
                    <Grid Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <GroupBox Header="Import and Export" Grid.Row="0" Margin="0,0,0,10">
                            <StackPanel Margin="5">

                                <TextBlock Text="Tools" FontWeight="Bold" Margin="5"/>
                                <StackPanel Orientation="Horizontal" Margin="5">
                                    <Button Content="Import Tools" Command="{Binding ImportToolsCommand}" Width="150" Margin="5"/>
                                    <Button Content="Export Tools" Command="{Binding ExportToolsCommand}" Width="150" Margin="5"/>
                                </StackPanel>

                                <TextBlock Text="Customers" FontWeight="Bold" Margin="10,10,5,5"/>
                                <StackPanel Orientation="Horizontal" Margin="5">
                                    <Button Content="Import Customers" Command="{Binding ImportCustomersCommand}" Width="150" Margin="5"/>
                                    <Button Content="Export Customers" Command="{Binding ExportCustomersCommand}" Width="150" Margin="5"/>
                                </StackPanel>

                                <TextBlock Text="Database" FontWeight="Bold" Margin="10,10,5,5"/>
                                <StackPanel Orientation="Horizontal" Margin="5">
                                    <Button Content="Backup Database" Click="BackupDatabaseButton_Click" Width="150" Margin="5"/>
                                </StackPanel>

                            </StackPanel>
                        </GroupBox>
                    </Grid>
                </TabItem>

                <TabItem Header="Activity Logs">
                    <Grid Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <StackPanel Orientation="Horizontal" Grid.Row="0" Margin="0,0,0,10">
                            <Button Content="Refresh Logs" Click="RefreshLogsButton_Click" Width="150" Margin="5"/>
                            <Button Content="Purge Logs" Click="PurgeLogsButton_Click" Width="150" Margin="5"/>
                        </StackPanel>

                        <ListView x:Name="ActivityLogsList" Grid.Row="1">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="Log ID" DisplayMemberBinding="{Binding LogID}" Width="80"/>
                                    <GridViewColumn Header="User ID" DisplayMemberBinding="{Binding UserID}" Width="80"/>
                                    <GridViewColumn Header="User Name" DisplayMemberBinding="{Binding UserName}" Width="150"/>
                                    <GridViewColumn Header="Action" DisplayMemberBinding="{Binding Action}" Width="400"/>
                                    <GridViewColumn Header="Timestamp" Width="180">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Timestamp, StringFormat=\{0:yyyy-MM-dd HH:mm:ss\}}"/>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                </GridView>
                            </ListView.View>
                        </ListView>
                    </Grid>
                </TabItem>

                <TabItem Header="Reports">
                    <Grid Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <GroupBox Header="Print Reports" Grid.Row="0" Margin="0,0,0,10">
                            <StackPanel Margin="5">

                                <StackPanel Orientation="Horizontal" Margin="5">
                                    <Button Content="Print Inventory Report" Click="PrintInventoryReport_Click" Width="200" Margin="5"/>
                                    <Button Content="Print Active Rentals" Click="PrintActiveRentalsReport_Click" Width="200" Margin="5"/>
                                    <Button Content="Print Full Rental History" Click="PrintFullRentalReport_Click" Width="200" Margin="5"/>
                                    <Button Content="Print Rental Report" Click="PrintRentalReport_Click" Width="200" Margin="5"/>
                                </StackPanel>

                                <StackPanel Orientation="Horizontal" Margin="5">
                                    <Button Content="Print Activity Log" Click="PrintActivityLogReport_Click" Width="200" Margin="5"/>
                                    <Button Content="Print Customer Report" Click="PrintCustomerReport_Click" Width="200" Margin="5"/>
                                    <Button Content="Print User Report" Click="PrintUserReport_Click" Width="200" Margin="5"/>
                                </StackPanel>

                                <StackPanel Orientation="Horizontal" Margin="5">
                                    <Button Content="Print Summary Report" Click="PrintSummaryReport_Click" Width="200" Margin="5"/>
                                </StackPanel>

                            </StackPanel>
                        </GroupBox>
                    </Grid>
                </TabItem>


            </TabControl>

            <!-- Status Bar -->
            <StatusBar Grid.Row="1" Height="25" Background="LightGray">
                <StatusBarItem Content="Ready" />
            </StatusBar>
        </Grid>
    </DockPanel>
</Window>
